(function(){"use strict";var e={1399:function(e,t,a){var o=a(3751),s=a(641);const n={id:"app"};function r(e,t,a,o,r,i){const l=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",n,[(0,s.bF)(l)])}var i={name:"App"},l=a(6262);const c=(0,l.A)(i,[["render",r]]);var d=c,g=a(5220),u=a(33);const h=e=>((0,s.Qi)("data-v-5d5ba201"),e=e(),(0,s.jt)(),e),m={class:"news-selection-page"},p={class:"main-content"},f={class:"news-content"},k=h((()=>(0,s.Lk)("h1",null,"Новости для вас",-1))),v={class:"news-grid"},w=h((()=>(0,s.Lk)("div",{class:"news-image"},null,-1))),L={class:"news-details"},b=h((()=>(0,s.Lk)("button",null,"Обновить",-1))),y=["onClick"];function T(e,t,a,o,n,r){const i=(0,s.g2)("Header"),l=(0,s.g2)("Sidebar"),c=(0,s.g2)("TagsList"),d=(0,s.g2)("router-link"),g=(0,s.g2)("Footer");return(0,s.uX)(),(0,s.CE)("div",m,[(0,s.bF)(i),(0,s.Lk)("div",p,[(0,s.bF)(l),(0,s.Lk)("div",f,[k,(0,s.bF)(c,{onUpdateTags:r.fetchNewsByTag},null,8,["onUpdateTags"]),n.isEditorOrAdmin?((0,s.uX)(),(0,s.Wv)(d,{key:0,to:"/create-post"},{default:(0,s.k6)((()=>[(0,s.eW)("Создать новость")])),_:1})):(0,s.Q3)("",!0),(0,s.Lk)("div",v,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.newsFilteredList,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"news-card",key:e.id},[w,(0,s.Lk)("div",L,[(0,s.Lk)("h3",null,[(0,s.bF)(d,{to:"/news/"+e.id},{default:(0,s.k6)((()=>[(0,s.eW)((0,u.v_)(e.name),1)])),_:2},1032,["to"])])]),n.isEditorOrAdmin?((0,s.uX)(),(0,s.Wv)(d,{key:0,to:"/edit-post/"+e.id},{default:(0,s.k6)((()=>[b])),_:2},1032,["to"])):(0,s.Q3)("",!0),n.isEditorOrAdmin?((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:t=>r.deletePost(e.id)},"Удалить",8,y)):(0,s.Q3)("",!0)])))),128))])])]),(0,s.bF)(g)])}a(4114);const F=e=>((0,s.Qi)("data-v-041e6706"),e=e(),(0,s.jt)(),e),E={class:"header"},z={class:"header-content"},_=F((()=>(0,s.Lk)("h1",null,"Мои Новости",-1)));function C(e,t,a,o,n,r){const i=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("header",E,[(0,s.Lk)("div",z,[_,(0,s.Lk)("nav",null,[(0,s.bF)(i,{to:"/"},{default:(0,s.k6)((()=>[(0,s.eW)("Новости для вас")])),_:1}),r.isLoggedIn()?((0,s.uX)(),(0,s.Wv)(i,{key:0,to:"/magazines"},{default:(0,s.k6)((()=>[(0,s.eW)("Журналы")])),_:1})):(0,s.Q3)("",!0),(0,s.bF)(i,{to:"/choose-tags"},{default:(0,s.k6)((()=>[(0,s.eW)("Выбор тегов")])),_:1}),r.isLoggedIn()?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(i,{key:1,to:"/signup"},{default:(0,s.k6)((()=>[(0,s.eW)("Регистрация")])),_:1})),r.isLoggedIn()?((0,s.uX)(),(0,s.Wv)(i,{key:2,to:"/profile",class:"account-link"},{default:(0,s.k6)((()=>[(0,s.eW)("Мой аккаунт")])),_:1})):(0,s.Q3)("",!0),r.isLoggedIn()?((0,s.uX)(),(0,s.CE)("button",{key:3,onClick:t[0]||(t[0]=(...e)=>r.logout&&r.logout(...e))},"Выйти")):(0,s.Q3)("",!0)])])])}var I={name:"Header",data(){return{userProfile:null}},mounted(){const e=localStorage.getItem("authToken");this.isLoggedIn=!!e},methods:{isLoggedIn(){return!!localStorage.getItem("authToken")},logout(){localStorage.removeItem("authToken"),Po.push({path:"/"}).then((()=>{window.location.reload()}))}}};const S=(0,l.A)(I,[["render",C],["__scopeId","data-v-041e6706"]]);var P=S;const A=e=>((0,s.Qi)("data-v-00b101d0"),e=e(),(0,s.jt)(),e),X={class:"footer"},U={class:"footer-content"},$=A((()=>(0,s.Lk)("a",{href:"mailto:your-email@example.com"},"Контакты",-1)));function M(e,t,a,o,n,r){const i=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("footer",X,[(0,s.Lk)("div",U,[(0,s.bF)(i,{to:"/about"},{default:(0,s.k6)((()=>[(0,s.eW)("О нас")])),_:1}),(0,s.bF)(i,{to:"/help"},{default:(0,s.k6)((()=>[(0,s.eW)("Помощь")])),_:1}),$])])}var Q={name:"Footer"};const W=(0,l.A)(Q,[["render",M],["__scopeId","data-v-00b101d0"]]);var q=W;const N=e=>((0,s.Qi)("data-v-dce1eb9a"),e=e(),(0,s.jt)(),e),O={class:"sidebar"},j=N((()=>(0,s.Lk)("h3",null,"Мои новости",-1))),J=(0,s.Fv)("<h4 data-v-dce1eb9a>Избранные теги</h4><ul data-v-dce1eb9a><li data-v-dce1eb9a>Спорт</li><li data-v-dce1eb9a>Музыка</li><li data-v-dce1eb9a>Кино</li><li data-v-dce1eb9a>Наука</li></ul><h4 data-v-dce1eb9a>Местные новости</h4><ul data-v-dce1eb9a><li data-v-dce1eb9a>Москва</li><li data-v-dce1eb9a>Липецк</li><li data-v-dce1eb9a>Воронеж</li><li data-v-dce1eb9a>Пермь</li></ul>",4),V={key:0},D={key:1},x={key:2},H=N((()=>(0,s.Lk)("li",null,"New York Times",-1))),B=N((()=>(0,s.Lk)("li",null,"Биография",-1))),K=N((()=>(0,s.Lk)("li",null,"Esquire",-1))),R=N((()=>(0,s.Lk)("li",null,"Elle",-1))),Y=[H,B,K,R];function G(e,t,a,o,n,r){return(0,s.uX)(),(0,s.CE)("aside",O,[j,(0,s.Lk)("nav",null,[J,r.isLoggedIn()?((0,s.uX)(),(0,s.CE)("h4",V,"Мои журналы")):(0,s.Q3)("",!0),r.isLoggedIn()?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("h4",D,"Зарегистрируйтесь для получения доступа к журналам")),r.isLoggedIn()?((0,s.uX)(),(0,s.CE)("ul",x,Y)):(0,s.Q3)("",!0)])])}var Z={name:"Sidebar",methods:{isLoggedIn(){return!!localStorage.getItem("authToken")}}};const ee=(0,l.A)(Z,[["render",G],["__scopeId","data-v-dce1eb9a"]]);var te=ee,ae=a(4335);const oe=ae.A.create({baseURL:"http://localhost:8080/api",withCredentials:!1,headers:{Accept:"application/json","Content-Type":"application/json"}});function se(e){let t=null;if(document.cookie&&""!==document.cookie){const a=document.cookie.split(";");for(let o=0;o<a.length;o++){const s=a[o].trim();if(s.substring(0,e.length+1)===e+"="){t=decodeURIComponent(s.substring(e.length+1));break}}}return t}oe.interceptors.request.use((e=>{if(!e.url.includes("/posts")){const t=localStorage.getItem("authToken");t&&(e.headers.Authorization=`Token ${t}`)}return e}),(e=>Promise.reject(e)));var ne={getTags(){return console.log("Получение тегов"),oe.get("/tags",{withCredentials:!0})},getNews(){return console.log("Получение новостей"),oe.get("/posts",{withCredentials:!0})},getNewsById(e){return console.log(`Получение новости с ID: ${e}`),oe.get(`/posts/${e}/`,{withCredentials:!0})},async getNewsByTags(e){return await ae.A.get("/posts/",{params:{tags:e.join(",")}})},getMagazines(){return console.log("Получение журналов"),oe.get("/magazines",{withCredentials:!0})},getMagazinesById(e){return console.log(`Получение журнала с ID: ${e}`),oe.get(`/magazines/${e}/`,{withCredentials:!0})},async getMagazinesByTags(e){return await ae.A.get("/magazines/",{params:{tags:e.join(",")}})},getUserProfile(e){return console.log("Получение профиля"),oe.get("/users/profile/",{headers:{Authorization:`Token ${e}`}})},login(e){console.log("Отправка данных для входа:",e);const t=se("csrftoken");return oe.post("/login/",e,{headers:{"X-CSRFToken":t}})},register(e){console.log("Отправка данных для регистрации:",e);const t=se("csrftoken");return oe.post("/register/",e,{headers:{"X-CSRFToken":t}})},createPost(e,t){return console.log("Отправка данных для создания поста:",e," ",t),oe.post("/posts/",e,t)},deletePost(e,t){return console.log("Отправка данных для удаления поста с ID:",e," ",t),oe.delete(`/posts/${e}/`,t)},updatePost(e,t,a){return console.log("Отправка данных для обновления поста с ID:",e," ",t," ",a),oe.put(`/posts/${e}/`,t,a)},createMagazine(e,t){return console.log("Отправка данных для создания поста:",e," ",t),oe.post("/magazines/",e,t)},deleteMagazine(e,t){return console.log("Отправка данных для удаления поста с ID:",e," ",t),oe.delete(`/magazines/${e}/`,t)},updateMagazine(e,t,a){return console.log("Отправка данных для обновления поста с ID:",e," ",t," ",a),oe.put(`/magazines/${e}/`,t,a)}};const re={class:"tags-list"};function ie(e,t,a,o,n,r){return(0,s.uX)(),(0,s.CE)("div",re,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.selectedTags,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,u.C4)(["tag",{selected:r.isSelected(e)}]),key:t},(0,u.v_)(e.tag_name)+"/"+(0,u.v_)(e.category),3)))),128))])}var le=a(8987),ce={name:"TagsList",data(){return{tags:[],selectedTags:[]}},async mounted(){try{const e=await ne.getTags();this.tags=e.data,this.selectedTags=this.getSavedTags(),console.log("Selected tags: ",this.selectedTags),this.$emit("update-tags",this.selectedTags)}catch(e){console.error("Ошибка при получении тегов:",e)}},methods:{isSelected(e){return this.selectedTags.includes(e)},getSavedTags(){const e=le.A.get("selectedTags");return e?JSON.parse(e):[]}}};const de=(0,l.A)(ce,[["render",ie],["__scopeId","data-v-8461fa00"]]);var ge=de,ue={name:"NewsSelectionPage",components:{TagsList:ge,Sidebar:te,Footer:q,Header:P},data(){return{newsList:[],selectedTags:[],newsFilteredList:[],searchQuery:"",userProfile:null,isEditorOrAdmin:!1}},created(){this.fetchUserProfile(),this.fetchNews()},watch:{"$route.query.q":{immediate:!0,handler(e){e?(this.searchQuery=e,this.fetchNewsByTag(e)):this.fetchNews()}}},methods:{async fetchUserProfile(){const e=localStorage.getItem("authToken");if(e){console.log("Fetching user profile with token:",e);try{const t=await ne.getUserProfile(e);this.userProfile=t.data,console.log(this.userProfile.role),"Admin"!==this.userProfile.role&&"Editor"!==this.userProfile.role||(this.isEditorOrAdmin=!0)}catch(t){console.error("Ошибка при загрузке профиля:",t)}}else console.log("Пользователь не авторизован.")},isLoggedIn(){return!!localStorage.getItem("authToken")},async fetchNews(){try{const e=await ne.getNews();this.newsList=e.data,console.log("Fetched news: ",e.data),this.newsList.forEach((e=>{console.log("News ID:",e.id)}))}catch(e){console.error("Error fetching news:",e)}},async fetchNewsByTag(e){console.log("Fetching news by tag..."),console.log("Selected tags:",e);const t=await ne.getNews();if(this.newsList=t.data,e&&0!==e.length)try{console.log("Selected tags are not empty, starting filter process..."),console.log("Fetched news (yet without tags): ",this.newsList),this.newsFilteredList=this.newsList.filter((t=>{console.log("Checking news:",t.name,"with tags:",t.tags),e.forEach((e=>{console.log("Checking if news contains tag:",e.id)}));const a=e.every((e=>t.tags.includes(e.id)));return console.log("Does news match selected tags?",a),a})),console.log("Fetched news by tag: ",this.newsFilteredList)}catch(a){console.error("Error fetching news by tag:",a)}else console.log("No tags, fetching news..."),this.newsFilteredList=this.newsList,console.log("Fetched news without tags: ",this.newsFilteredList)},search(){Po.push({path:"/",query:{q:this.searchQuery}})},async deletePost(e){try{const t=localStorage.getItem("authToken");if(!t)return void console.error("Token not found!");const a={Authorization:`Token ${t}`};await ne.deletePost(e,{headers:a}),await this.fetchNews(),window.location.reload()}catch(t){console.error("Error deleting post:",t)}}}};const he=(0,l.A)(ue,[["render",T],["__scopeId","data-v-5d5ba201"]]);var me=he;const pe=e=>((0,s.Qi)("data-v-3deb1bb8"),e=e(),(0,s.jt)(),e),fe={class:"registration-page"},ke={class:"registration-form"},ve=pe((()=>(0,s.Lk)("h2",null,"Регистрация",-1))),we={class:"form-group"},Le=pe((()=>(0,s.Lk)("label",{for:"name"},"Имя пользователя",-1))),be={class:"form-group"},ye=pe((()=>(0,s.Lk)("label",{for:"surname"},"Фамилия пользователя",-1))),Te={class:"patronymic"},Fe=pe((()=>(0,s.Lk)("label",{for:"username"},"Отчество пользователя",-1))),Ee={class:"form-group"},ze=pe((()=>(0,s.Lk)("label",{for:"login"},"Логин",-1))),_e={class:"form-group"},Ce=pe((()=>(0,s.Lk)("label",{for:"email"},"Почта",-1))),Ie={class:"form-group"},Se=pe((()=>(0,s.Lk)("label",{for:"password"},"Пароль",-1))),Pe={class:"form-group"},Ae=pe((()=>(0,s.Lk)("label",{for:"confirmPassword"},"Повторите пароль",-1))),Xe={class:"form-group"},Ue={key:0,class:"password-match"},$e={key:1,class:"password-no-match"},Me=["disabled"],Qe=pe((()=>(0,s.Lk)("div",{class:"form-group"},[(0,s.Lk)("label",{for:"confirmPassword"},"Повторите пароль")],-1))),We={class:"form-group"},qe={for:"confirmPassword"},Ne={class:"form-group"};function Oe(e,t,a,n,r,i){const l=(0,s.g2)("router-link"),c=(0,s.g2)("Footer");return(0,s.uX)(),(0,s.CE)("div",fe,[(0,s.Lk)("div",ke,[ve,(0,s.Lk)("form",{onSubmit:t[7]||(t[7]=(0,o.D$)(((...e)=>i.register&&i.register(...e)),["prevent"]))},[(0,s.Lk)("div",we,[Le,(0,s.bo)((0,s.Lk)("input",{type:"text",id:"name","onUpdate:modelValue":t[0]||(t[0]=e=>r.name=e),required:""},null,512),[[o.Jo,r.name]])]),(0,s.Lk)("div",be,[ye,(0,s.bo)((0,s.Lk)("input",{type:"text",id:"surname","onUpdate:modelValue":t[1]||(t[1]=e=>r.surname=e),required:""},null,512),[[o.Jo,r.surname]])]),(0,s.Lk)("div",Te,[Fe,(0,s.bo)((0,s.Lk)("input",{type:"text",id:"patronymic","onUpdate:modelValue":t[2]||(t[2]=e=>r.patronymic=e),required:""},null,512),[[o.Jo,r.patronymic]])]),(0,s.Lk)("div",Ee,[ze,(0,s.bo)((0,s.Lk)("input",{type:"text",id:"login","onUpdate:modelValue":t[3]||(t[3]=e=>r.login=e),required:""},null,512),[[o.Jo,r.login]])]),(0,s.Lk)("div",_e,[Ce,(0,s.bo)((0,s.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[4]||(t[4]=e=>r.email=e),required:""},null,512),[[o.Jo,r.email]])]),(0,s.Lk)("div",Ie,[Se,(0,s.bo)((0,s.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":t[5]||(t[5]=e=>r.password=e),required:""},null,512),[[o.Jo,r.password]])]),(0,s.Lk)("div",Pe,[Ae,(0,s.bo)((0,s.Lk)("input",{type:"password",id:"confirmPassword","onUpdate:modelValue":t[6]||(t[6]=e=>r.confirmPassword=e),required:""},null,512),[[o.Jo,r.confirmPassword]])]),(0,s.Lk)("div",Xe,[r.passwordsMatch?((0,s.uX)(),(0,s.CE)("p",Ue,"Пароли совпадают")):((0,s.uX)(),(0,s.CE)("p",$e,"Пароли не совпадают"))]),(0,s.Lk)("button",{type:"submit",disabled:!r.passwordsMatch},"Зарегистрироваться",8,Me),Qe,(0,s.Lk)("div",We,[(0,s.Lk)("label",qe,[(0,s.eW)("Есть аккаунт? "),(0,s.bF)(l,{to:"/login"},{default:(0,s.k6)((()=>[(0,s.eW)("Авторизироваться")])),_:1})])]),(0,s.Lk)("div",Ne,[(0,s.bF)(l,{to:"/"},{default:(0,s.k6)((()=>[(0,s.eW)("На главную")])),_:1})])],32)]),(0,s.bF)(c)])}var je={name:"Registration",components:{Footer:q},data(){return{name:"",surname:"",patronymic:"",login:"",email:"",password:"",confirmPassword:"",passwordsMatch:!0}},watch:{password(){this.checkPasswordsMatch()},confirmPassword(){this.checkPasswordsMatch()}},methods:{checkPasswordsMatch(){this.passwordsMatch=this.password===this.confirmPassword},isLoggedIn(){return!!localStorage.getItem("authToken")},async register(){try{const e=le.A.get("csrftoken"),t=await ae.A.post("http://localhost:8080/api/register/",{name:this.name,surname:this.surname,patronymic:this.patronymic,mail:this.email,login:this.login,password:this.password,confirm_password:this.confirmPassword},{headers:{"X-CSRFToken":e}});console.log("User registered:",t.data),localStorage.setItem("authToken",t.data.token),await Po.push({path:"/"}),window.location.reload()}catch(e){console.error("Error registering user:",e)}}}};const Je=(0,l.A)(je,[["render",Oe],["__scopeId","data-v-3deb1bb8"]]);var Ve=Je;const De=e=>((0,s.Qi)("data-v-533b287a"),e=e(),(0,s.jt)(),e),xe={class:"login-page"},He={class:"login-form"},Be=De((()=>(0,s.Lk)("h2",null,"Вход",-1))),Ke={class:"form-group"},Re=De((()=>(0,s.Lk)("label",{for:"username"},"Логин",-1))),Ye={class:"form-group"},Ge=De((()=>(0,s.Lk)("label",{for:"password"},"Пароль",-1))),Ze=De((()=>(0,s.Lk)("button",{type:"submit"},"Войти",-1))),et={class:"form-group"},tt={for:"signup"},at={class:"form-group"};function ot(e,t,a,n,r,i){const l=(0,s.g2)("router-link"),c=(0,s.g2)("Footer");return(0,s.uX)(),(0,s.CE)("div",xe,[(0,s.Lk)("div",He,[Be,(0,s.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)(((...e)=>i.login&&i.login(...e)),["prevent"]))},[(0,s.Lk)("div",Ke,[Re,(0,s.bo)((0,s.Lk)("input",{type:"text",id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>r.username=e),required:""},null,512),[[o.Jo,r.username]])]),(0,s.Lk)("div",Ye,[Ge,(0,s.bo)((0,s.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":t[1]||(t[1]=e=>r.password=e),required:""},null,512),[[o.Jo,r.password]])]),Ze,(0,s.Lk)("div",et,[(0,s.Lk)("label",tt,[(0,s.eW)("Нет аккаунта? "),(0,s.bF)(l,{to:"/signup"},{default:(0,s.k6)((()=>[(0,s.eW)("Зарегистрироваться")])),_:1})])]),(0,s.Lk)("div",at,[(0,s.bF)(l,{to:"/"},{default:(0,s.k6)((()=>[(0,s.eW)("На главную")])),_:1})])],32)]),(0,s.bF)(c)])}var st={name:"LoginPage",data(){return{username:"",password:""}},components:{Footer:q},methods:{getCookie(e){let t=null;if(document.cookie&&""!==document.cookie){const a=document.cookie.split(";");for(let o=0;o<a.length;o++){const s=a[o].trim();if(s.substring(0,e.length+1)===e+"="){t=decodeURIComponent(s.substring(e.length+1));break}}}return t},async login(){try{console.log("Запуск скрипта..."),ae.A.defaults.headers.common["X-CSRFToken"]=this.getCookie("csrftoken"),console.log("Получение заголовка...");const e=await ne.login({username:this.username,password:this.password});return console.log("Данные ответа: ",e),console.log("Получение ответа от сервера..."),console.log("Данные: ",e.data),console.log("Токен: ",e.data.token),e.data&&e.data.token?(localStorage.setItem("authToken",e.data.token),console.log("Получение токена..."),ae.A.defaults.headers.common["Authorization"]=`Token ${e.data.token}`,console.log("Токен:",localStorage.getItem("authToken")),await Po.push({path:"/"}),window.location.reload()):console.error("Токен не найден в ответе:",e.data),e}catch(e){console.error("Ошибка при входе в аккаунт:",e.response?e.response.data:e.message)}}}};const nt=(0,l.A)(st,[["render",ot],["__scopeId","data-v-533b287a"]]);var rt=nt;const it={class:"tags-page"},lt={class:"tags-container"},ct=["onClick"];function dt(e,t,a,o,n,r){const i=(0,s.g2)("HeaderWide"),l=(0,s.g2)("Footer");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(i),(0,s.Lk)("div",it,[(0,s.Lk)("div",lt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.tags,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,u.C4)(["tag",{selected:r.isSelected(e)}]),key:t,onClick:t=>r.toggleTag(e)},(0,u.v_)(e.tag_name)+"/"+(0,u.v_)(e.category),11,ct)))),128))]),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>r.clearAllTags&&r.clearAllTags(...e)),class:"clear-tags-button"},"Удалить все теги"),(0,s.bF)(l)])],64)}const gt={class:"header-wide"},ut={class:"header-content"};function ht(e,t,a,o,n,r){const i=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("header",gt,[(0,s.Lk)("div",ut,[(0,s.bF)(i,{to:"/"},{default:(0,s.k6)((()=>[(0,s.eW)("Новости для вас")])),_:1}),r.isLoggedIn()?((0,s.uX)(),(0,s.Wv)(i,{key:0,to:"/magazines"},{default:(0,s.k6)((()=>[(0,s.eW)("Мои журналы")])),_:1})):(0,s.Q3)("",!0),(0,s.bF)(i,{to:"/choose-tags"},{default:(0,s.k6)((()=>[(0,s.eW)("Выбор тегов")])),_:1})])])}var mt={name:"HeaderWide",data(){return{userProfile:null}},mounted(){const e=localStorage.getItem("authToken");this.isLoggedIn=!!e},methods:{isLoggedIn(){return!!localStorage.getItem("authToken")},logout(){localStorage.removeItem("authToken"),Po.push({path:"/"}).then((()=>{window.location.reload()}))}}};const pt=(0,l.A)(mt,[["render",ht],["__scopeId","data-v-adb60e20"]]);var ft=pt,kt={name:"Tags",components:{HeaderWide:ft,Footer:q},data(){return{tags:[],selectedTags:[]}},async mounted(){try{const e=await ne.getTags();e.data&&Array.isArray(e.data)?(this.tags=e.data,console.log("Fetched tags:",this.tags),this.selectedTags=this.getSavedTags(),console.log("Loaded saved tags:",this.selectedTags)):console.error("Invalid tags data format:",e.data)}catch(e){console.error("Error fetching tags:",e)}},methods:{toggleTag(e){const t=this.selectedTags.findIndex((t=>t.tag_name===e.tag_name&&t.category===e.category));-1!==t?(this.selectedTags.splice(t,1),console.log(`Tag ${e} removed. Selected tags:`,this.selectedTags)):(this.selectedTags.push(e),console.log(`Tag ${e} added. Selected tags:`,this.selectedTags)),this.saveTags(this.selectedTags),this.$emit("update-tags",this.selectedTags)},isSelected(e){return this.selectedTags.some((t=>t.tag_name===e.tag_name&&t.category===e.category))},getSavedTags(){try{const e=le.A.get("selectedTags");if(e){const t=JSON.parse(e);return Array.isArray(t)?t:(console.error("Saved tags format is invalid:",e),[])}}catch(e){console.error("Error parsing saved tags from cookies:",e)}return[]},saveTags(e){try{le.A.set("selectedTags",JSON.stringify(e),{expires:7}),console.log("Selected tags saved to cookies:",e)}catch(t){console.error("Error saving tags to cookies:",t)}},clearAllTags(){this.selectedTags=[],this.saveTags(this.selectedTags),this.$emit("update-tags",this.selectedTags)}}};const vt=(0,l.A)(kt,[["render",dt],["__scopeId","data-v-6e37ad04"]]);var wt=vt;const Lt={class:"page-container"},bt={class:"main-content"},yt={class:"news-list"},Tt={key:0},Ft=["href"];function Et(e,t,a,o,n,r){const i=(0,s.g2)("Header"),l=(0,s.g2)("Sidebar"),c=(0,s.g2)("Footer");return(0,s.uX)(),(0,s.CE)("div",Lt,[(0,s.bF)(i),(0,s.Lk)("div",bt,[(0,s.bF)(l),(0,s.Lk)("div",yt,[(0,s.Lk)("div",null,[(0,s.Lk)("h1",null,(0,u.v_)(n.news.name||"Loading..."),1),(0,s.Lk)("p",null,(0,u.v_)(n.news.description||"Loading description..."),1),n.news.file?((0,s.uX)(),(0,s.CE)("div",Tt,[(0,s.Lk)("a",{href:n.news.file,target:"_blank"},"Download File",8,Ft)])):(0,s.Q3)("",!0)])])]),(0,s.bF)(c)])}var zt={name:"NewsDetail",components:{Header:P,Sidebar:te,Footer:q},created(){this.fetchNews()},props:{id:{type:String,required:!0}},data(){return{news:{}}},methods:{async fetchNews(){const e=this.$route.params.id;console.log("Fetching news with ID:",e);try{const t=await ne.getNewsById(e);this.news=t.data}catch(t){console.error("Ошибка при загрузке новости:",t)}}}};const _t=(0,l.A)(zt,[["render",Et],["__scopeId","data-v-5cf39e48"]]);var Ct=_t;const It=e=>((0,s.Qi)("data-v-3700bc74"),e=e(),(0,s.jt)(),e),St={class:"page-container"},Pt={class:"main-content"},At={class:"magazines-list"},Xt=It((()=>(0,s.Lk)("h1",null,"Журналы для вас",-1))),Ut={class:"magazines-grid"},$t=It((()=>(0,s.Lk)("div",{class:"magazine-image"},null,-1))),Mt={class:"magazine-details"},Qt=It((()=>(0,s.Lk)("button",null,"Обновить",-1))),Wt=["onClick"];function qt(e,t,a,o,n,r){const i=(0,s.g2)("Header"),l=(0,s.g2)("Sidebar"),c=(0,s.g2)("TagsList"),d=(0,s.g2)("router-link"),g=(0,s.g2)("Footer");return(0,s.uX)(),(0,s.CE)("div",St,[(0,s.bF)(i),(0,s.Lk)("div",Pt,[(0,s.bF)(l),(0,s.Lk)("div",At,[Xt,(0,s.bF)(c,{onTagSelected:r.fetchMagazinesByTag},null,8,["onTagSelected"]),n.isEditorOrAdmin?((0,s.uX)(),(0,s.Wv)(d,{key:0,to:"/create-magazine"},{default:(0,s.k6)((()=>[(0,s.eW)("Создать журнал")])),_:1})):(0,s.Q3)("",!0),(0,s.Lk)("div",Ut,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.magazineList,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"magazine-card",key:e.id},[$t,(0,s.Lk)("div",Mt,[(0,s.Lk)("h3",null,[(0,s.bF)(d,{to:"/magazine/"+e.id},{default:(0,s.k6)((()=>[(0,s.eW)((0,u.v_)(e.name),1)])),_:2},1032,["to"])])]),n.isEditorOrAdmin?((0,s.uX)(),(0,s.Wv)(d,{key:0,to:"/edit-magazine/"+e.id},{default:(0,s.k6)((()=>[Qt])),_:2},1032,["to"])):(0,s.Q3)("",!0),n.isEditorOrAdmin?((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:t=>r.deleteMagazine(e.id)},"Удалить",8,Wt)):(0,s.Q3)("",!0)])))),128))])])]),(0,s.bF)(g)])}var Nt={name:"MagazinesPage",components:{TagsList:ge,Header:P,Sidebar:te,Footer:q},data(){return{magazineList:[],selectedTags:[],magazineFilteredList:[],searchQuery:"",userProfile:null,isEditorOrAdmin:!1}},created(){this.fetchUserProfile(),this.fetchMagazines()},watch:{"$route.query.q":{immediate:!0,handler(e){e?(this.searchQuery=e,this.fetchMagazinesByTag(e)):this.fetchMagazines()}}},methods:{async fetchUserProfile(){const e=localStorage.getItem("authToken");if(e){console.log("Fetching user profile with token:",e);try{const e=await ne.getUserProfile();this.userProfile=e.data,console.log(this.userProfile.role),"Admin"!==this.userProfile.role&&"Editor"!==this.userProfile.role||(this.isEditorOrAdmin=!0)}catch(t){console.error("Ошибка при загрузке профиля:",t)}}else console.log("Пользователь не авторизован.")},isLoggedIn(){return!!localStorage.getItem("authToken")},async fetchMagazines(){try{console.log("Start fetching magazines...");const e=await ne.getMagazines();this.magazineList=e.data,console.log("Fetched magazines: ",e.data),this.magazineList.forEach((e=>{console.log("News ID:",e.id)}))}catch(e){console.error("Error fetching magazines:",e)}},async fetchMagazinesByTag(e){const t=await ne.getMagazines();if(this.magazineList=t.data,e&&0!==e.length)try{console.log("Selected tags are not empty, starting filter process..."),console.log("Fetched magazines (yet without tags): ",this.newsList),this.magazineFilteredList=this.magazineList.filter((t=>{console.log("Checking magazines:",t.name,"with tags:",t.tags),e.forEach((e=>{console.log("Checking if magazines contains tag:",e.id)}));const a=e.every((e=>t.tags.includes(e.id)));return console.log("Does magazines match selected tags?",a),a})),console.log("Fetched magazines by tag: ",this.magazineFilteredList)}catch(a){console.error("Error fetching magazines by tag:",a)}else console.log("No tags, fetching magazines..."),this.magazineFilteredList=this.magazineList,console.log("Fetched magazines without tags: ",this.magazineFilteredList)},search(){Po.push({path:"/",query:{q:this.searchQuery}})},async deleteMagazine(e){try{const t=localStorage.getItem("authToken");if(!t)return void console.error("Token not found!");const a={Authorization:`Token ${t}`};await ne.deletePost(e,{headers:a}),await this.fetchMagazines(),window.location.reload()}catch(t){console.error("Error deleting magazine:",t)}}}};const Ot=(0,l.A)(Nt,[["render",qt],["__scopeId","data-v-3700bc74"]]);var jt=Ot;const Jt=e=>((0,s.Qi)("data-v-29e87115"),e=e(),(0,s.jt)(),e),Vt={class:"profile"},Dt=Jt((()=>(0,s.Lk)("h1",null,"Мой профиль",-1))),xt={class:"avatar"},Ht=Jt((()=>(0,s.Lk)("div",{class:"avatar-placeholder"},"+",-1))),Bt={class:"form-group"},Kt=Jt((()=>(0,s.Lk)("label",{for:"email"},"e-mail",-1))),Rt={class:"form-group"},Yt=Jt((()=>(0,s.Lk)("label",{for:"first_name"},"Имя",-1))),Gt={class:"form-group"},Zt=Jt((()=>(0,s.Lk)("label",{for:"last_name"},"Фамилия",-1))),ea=Jt((()=>(0,s.Lk)("button",{type:"submit"},"Сохранить данные",-1))),ta=Jt((()=>(0,s.Lk)("h2",null,"Смена пароля",-1))),aa={class:"form-group"},oa=Jt((()=>(0,s.Lk)("label",{for:"new_password"},"Старый пароль",-1))),sa={class:"form-group"},na=Jt((()=>(0,s.Lk)("label",{for:"new_password"},"Новый пароль",-1))),ra={class:"form-group"},ia=Jt((()=>(0,s.Lk)("label",{for:"confirm_password"},"Повтор пароля",-1))),la=Jt((()=>(0,s.Lk)("button",{type:"submit"},"Изменить пароль",-1))),ca={key:0},da={key:1};function ga(e,t,a,n,r,i){const l=(0,s.g2)("Header-wide"),c=(0,s.g2)("Footer");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(l),(0,s.Lk)("div",Vt,[Dt,(0,s.Lk)("form",{onSubmit:t[4]||(t[4]=(0,o.D$)(((...e)=>i.updateProfile&&i.updateProfile(...e)),["prevent"]))},[(0,s.Lk)("div",xt,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>i.uploadAvatar&&i.uploadAvatar(...e))},"Добавить аватар"),Ht]),(0,s.Lk)("div",Bt,[Kt,(0,s.bo)((0,s.Lk)("input",{type:"email","onUpdate:modelValue":t[1]||(t[1]=e=>r.user.email=e),id:"email",readonly:""},null,512),[[o.Jo,r.user.email]])]),(0,s.Lk)("div",Rt,[Yt,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>r.user.first_name=e),id:"first_name"},null,512),[[o.Jo,r.user.first_name]])]),(0,s.Lk)("div",Gt,[Zt,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>r.user.last_name=e),id:"last_name"},null,512),[[o.Jo,r.user.last_name]])]),ea],32),ta,(0,s.Lk)("form",{onSubmit:t[8]||(t[8]=(0,o.D$)(((...e)=>i.changePassword&&i.changePassword(...e)),["prevent"]))},[(0,s.Lk)("div",aa,[oa,(0,s.bo)((0,s.Lk)("input",{type:"password","onUpdate:modelValue":t[5]||(t[5]=e=>r.password.old=e),id:"new_password"},null,512),[[o.Jo,r.password.old]])]),(0,s.Lk)("div",sa,[na,(0,s.bo)((0,s.Lk)("input",{type:"password","onUpdate:modelValue":t[6]||(t[6]=e=>r.password.new=e),id:"new_password"},null,512),[[o.Jo,r.password.new]])]),(0,s.Lk)("div",ra,[ia,(0,s.bo)((0,s.Lk)("input",{type:"password","onUpdate:modelValue":t[7]||(t[7]=e=>r.password.confirm=e),id:"confirm_password"},null,512),[[o.Jo,r.password.confirm]])]),la,r.error?((0,s.uX)(),(0,s.CE)("p",ca,(0,u.v_)(r.error),1)):(0,s.Q3)("",!0),r.success?((0,s.uX)(),(0,s.CE)("p",da,(0,u.v_)(r.success),1)):(0,s.Q3)("",!0)],32)]),(0,s.bF)(c)],64)}var ua={name:"account",components:{HeaderWide:ft,Footer:q},data(){return{user:{email:"",first_name:"",last_name:"",date_of_birth:""},password:{new:"",confirm:"",old:""},error:null,success:null}},created(){this.fetchUserProfile()},methods:{async fetchUserProfile(){const e=localStorage.getItem("authToken");if(e){console.log("Fetching user profile with token:",e);try{const t=await ne.getUserProfile(e);this.userProfile=t.data,console.log(this.userProfile.role),"Admin"!==this.userProfile.role&&"Editor"!==this.userProfile.role||(this.isEditorOrAdmin=!0)}catch(t){console.error("Ошибка при загрузке профиля:",t)}}else console.log("Пользователь не авторизован.")},async updateProfile(){try{await ne.put("/api/profile/",this.user),alert("Данные профиля обновлены")}catch(e){console.error("Error updating profile:",e)}},async changePassword(){if(this.password.new===this.password.confirm)try{const e=await ne.post("/api/change-password/",{new_password:this.password.new,confirm_password:this.password.confirm,old_password:this.password.old});this.success=e.data.success,this.error=null}catch(e){this.error=e.response.data.error,this.success=null,console.error("Error changing password:",e)}else alert("Пароли не совпадают")},uploadAvatar(){}}};const ha=(0,l.A)(ua,[["render",ga],["__scopeId","data-v-29e87115"]]);var ma=ha;const pa=e=>((0,s.Qi)("data-v-0a4f5a4e"),e=e(),(0,s.jt)(),e),fa={class:"page-container"},ka={class:"main-content"},va={class:"content"},wa=pa((()=>(0,s.Lk)("h2",null,"Создание публикации",-1))),La={class:"form-group"},ba=pa((()=>(0,s.Lk)("label",{for:"title"},"Заголовок:",-1))),ya={class:"form-group"},Ta=pa((()=>(0,s.Lk)("label",{for:"content"},"Текст публикации:",-1))),Fa={class:"form-group"},Ea=pa((()=>(0,s.Lk)("label",{for:"preview"},"Превью:",-1))),za={class:"form-group"},_a=pa((()=>(0,s.Lk)("label",{for:"tags"},"Теги:",-1))),Ca=["value"],Ia=pa((()=>(0,s.Lk)("button",{type:"submit"},"Опубликовать",-1)));function Sa(e,t,a,n,r,i){const l=(0,s.g2)("Header"),c=(0,s.g2)("Sidebar"),d=(0,s.g2)("Footer");return(0,s.uX)(),(0,s.CE)("div",fa,[(0,s.bF)(l),(0,s.Lk)("div",ka,[(0,s.bF)(c),(0,s.Lk)("div",va,[wa,(0,s.Lk)("form",{onSubmit:t[4]||(t[4]=(0,o.D$)(((...e)=>i.submitForm&&i.submitForm(...e)),["prevent"]))},[(0,s.Lk)("div",La,[ba,(0,s.bo)((0,s.Lk)("input",{type:"text",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>r.title=e),required:""},null,512),[[o.Jo,r.title]])]),(0,s.Lk)("div",ya,[Ta,(0,s.bo)((0,s.Lk)("textarea",{id:"content","onUpdate:modelValue":t[1]||(t[1]=e=>r.content=e),required:""},null,512),[[o.Jo,r.content]])]),(0,s.Lk)("div",Fa,[Ea,(0,s.Lk)("input",{type:"file",id:"preview",onChange:t[2]||(t[2]=(...e)=>i.handleFileUpload&&i.handleFileUpload(...e))},null,32)]),(0,s.Lk)("div",za,[_a,(0,s.bo)((0,s.Lk)("select",{id:"tags","onUpdate:modelValue":t[3]||(t[3]=e=>r.selectedTag=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.tags,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.id},(0,u.v_)(e.tag_name),9,Ca)))),128))],512),[[o.u1,r.selectedTag]])]),Ia],32)])]),(0,s.bF)(d)])}var Pa={name:"CreatePostPage",components:{Header:P,Sidebar:te,Footer:q},data(){return{title:"",content:"",selectedTag:"",tags:[]}},created(){this.$route.params.id&&this.fetchPost(),this.fetchTags()},methods:{handleFileUpload(e){},async submitForm(){this.$route.params.id?await this.updatePost():await this.createPost()},async fetchTags(){try{const e=await ne.getTags();this.tags=e.data}catch(e){console.error("Error fetching tags:",e)}},async createPost(){try{const e={name:this.title,description:this.content,tags:[this.selectedTag]},t=localStorage.getItem("authToken");if(!t)return void console.error("Token not found!");const a={Authorization:`Token ${t}`};await ne.createPost(e,{headers:a}),this.$router.push("/")}catch(e){console.error("Error creating post:",e)}},async fetchPost(){try{const e=await ne.getNewsById(this.$route.params.id);this.title=e.data.name,this.content=e.data.description,this.selectedTag=e.data.tags[0]}catch(e){console.error("Error fetching post:",e)}},async updatePost(){try{const e={name:this.title,description:this.content,tags:[this.selectedTag]},t=localStorage.getItem("authToken");if(!t)return void console.error("Token not found!");const a={Authorization:`Token ${t}`};await ne.updatePost(this.$route.params.id,e,{headers:a}),this.$router.push("/")}catch(e){console.error("Error updating post:",e)}}}};const Aa=(0,l.A)(Pa,[["render",Sa],["__scopeId","data-v-0a4f5a4e"]]);var Xa=Aa;const Ua=e=>((0,s.Qi)("data-v-22b56a0d"),e=e(),(0,s.jt)(),e),$a={class:"page-container"},Ma={class:"main-content"},Qa={class:"content"},Wa=Ua((()=>(0,s.Lk)("h2",null,"Добавить редактора",-1))),qa={class:"form-group"},Na=Ua((()=>(0,s.Lk)("label",{for:"name"},"Л:",-1))),Oa={class:"form-group"},ja=Ua((()=>(0,s.Lk)("label",{for:"email"},"Почта:",-1))),Ja={class:"form-group"},Va=Ua((()=>(0,s.Lk)("label",{for:"magazines"},"Журналы:",-1))),Da=["value"],xa=Ua((()=>(0,s.Lk)("button",{type:"submit"},"Добавить",-1))),Ha=Ua((()=>(0,s.Lk)("h2",null,"Список редакторов",-1))),Ba=Ua((()=>(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Редакторы"),(0,s.Lk)("th",null,"Журналы"),(0,s.Lk)("th",null,"e-mail"),(0,s.Lk)("th",null,"Удалить")])],-1))),Ka=["onClick"];function Ra(e,t,a,n,r,i){const l=(0,s.g2)("Header"),c=(0,s.g2)("Sidebar"),d=(0,s.g2)("Footer");return(0,s.uX)(),(0,s.CE)("div",$a,[(0,s.bF)(l),(0,s.Lk)("div",Ma,[(0,s.bF)(c),(0,s.Lk)("div",Qa,[Wa,(0,s.Lk)("form",{onSubmit:t[3]||(t[3]=(0,o.D$)(((...e)=>i.addEditor&&i.addEditor(...e)),["prevent"]))},[(0,s.Lk)("div",qa,[Na,(0,s.bo)((0,s.Lk)("input",{type:"text",id:"name","onUpdate:modelValue":t[0]||(t[0]=e=>r.newEditor.login=e),required:""},null,512),[[o.Jo,r.newEditor.login]])]),(0,s.Lk)("div",Oa,[ja,(0,s.bo)((0,s.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>r.newEditor.email=e),required:""},null,512),[[o.Jo,r.newEditor.email]])]),(0,s.Lk)("div",Ja,[Va,(0,s.bo)((0,s.Lk)("select",{id:"magazines","onUpdate:modelValue":t[2]||(t[2]=e=>r.newEditor.magazines=e),multiple:""},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.magazines,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,u.v_)(e),9,Da)))),128))],512),[[o.u1,r.newEditor.magazines]])]),xa],32),Ha,(0,s.Lk)("table",null,[Ba,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.editors,((e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:t},[(0,s.Lk)("td",null,(0,u.v_)(t+1)+". "+(0,u.v_)(e.name),1),(0,s.Lk)("td",null,(0,u.v_)(e.magazines.join(", ")),1),(0,s.Lk)("td",null,(0,u.v_)(e.email),1),(0,s.Lk)("td",null,[(0,s.Lk)("button",{onClick:e=>i.removeEditor(t)},"Удалить",8,Ka)])])))),128))])])])]),(0,s.bF)(d)])}var Ya={name:"ManageEditorsPage",components:{Header:P,Sidebar:te,Footer:q},data(){return{newEditor:{name:"",email:"",magazines:[]},magazines:["7 дней","Elle","New York Times","Биография","Esquire"],editors:[{name:"Петров Иван В.",email:"petrov12@mail.ru",magazines:["7 дней","Elle"]}],users:[]}},created(){this.fetchUsers()},methods:{async fetchUsers(){try{const e=await ne.get("/users/");this.users=e.data}catch(e){console.error("Error fetching users:",e)}},async deleteUser(e){try{await ne.delete(`/users/${e}/`),await this.fetchUsers()}catch(t){console.error("Error deleting user:",t)}},async addEditor(){try{await ne.post("/api/editors/",{name:this.newEditor.name,email:this.newEditor.email,magazines:this.newEditor.magazines}),this.newEditor.name="",this.newEditor.email="",this.newEditor.magazines=[],await this.fetchUsers()}catch(e){console.error("Error adding editor:",e)}},async removeEditor(e){const t=this.editors[e];try{await ne.delete(`/api/editors/${t.email}/`),this.editors.splice(e,1)}catch(a){console.error("Error removing editor:",a)}}}};const Ga=(0,l.A)(Ya,[["render",Ra],["__scopeId","data-v-22b56a0d"]]);var Za=Ga;const eo={class:"page-container"},to={class:"main-content"},ao={class:"magazines-list"},oo={key:0},so=["href"];function no(e,t,a,o,n,r){const i=(0,s.g2)("Header"),l=(0,s.g2)("Sidebar"),c=(0,s.g2)("Footer");return(0,s.uX)(),(0,s.CE)("div",eo,[(0,s.bF)(i),(0,s.Lk)("div",to,[(0,s.bF)(l),(0,s.Lk)("div",ao,[(0,s.Lk)("div",null,[(0,s.Lk)("h1",null,(0,u.v_)(n.magazine.name||"Loading..."),1),(0,s.Lk)("p",null,(0,u.v_)(n.magazine.description||"Loading description..."),1),n.magazine.file?((0,s.uX)(),(0,s.CE)("div",oo,[(0,s.Lk)("a",{href:n.magazine.file,target:"_blank"},"Download File",8,so)])):(0,s.Q3)("",!0)])])]),(0,s.bF)(c)])}var ro={name:"MagazinesDetail",components:{Header:P,Sidebar:te,Footer:q},created(){this.fetchMagazines()},props:{id:{type:String,required:!0}},data(){return{magazine:{}}},methods:{async fetchMagazines(){const e=this.$route.params.id;console.log("Fetching magazine with ID:",e);try{const t=await ne.getMagazinesById(e);this.magazine=t.data}catch(t){console.error("Ошибка при загрузке журнала:",t)}}}};const io=(0,l.A)(ro,[["render",no],["__scopeId","data-v-1f9b610c"]]);var lo=io;const co=e=>((0,s.Qi)("data-v-2411a54f"),e=e(),(0,s.jt)(),e),go={class:"page-container"},uo={class:"main-content"},ho={class:"content"},mo=co((()=>(0,s.Lk)("h2",null,"Создание публикации",-1))),po={class:"form-group"},fo=co((()=>(0,s.Lk)("label",{for:"title"},"Заголовок:",-1))),ko={class:"form-group"},vo=co((()=>(0,s.Lk)("label",{for:"content"},"Текст публикации:",-1))),wo={class:"form-group"},Lo=co((()=>(0,s.Lk)("label",{for:"preview"},"Превью:",-1))),bo={class:"form-group"},yo=co((()=>(0,s.Lk)("label",{for:"tags"},"Теги:",-1))),To=["value"],Fo=co((()=>(0,s.Lk)("button",{type:"submit"},"Опубликовать",-1)));function Eo(e,t,a,n,r,i){const l=(0,s.g2)("Header"),c=(0,s.g2)("Sidebar"),d=(0,s.g2)("Footer");return(0,s.uX)(),(0,s.CE)("div",go,[(0,s.bF)(l),(0,s.Lk)("div",uo,[(0,s.bF)(c),(0,s.Lk)("div",ho,[mo,(0,s.Lk)("form",{onSubmit:t[4]||(t[4]=(0,o.D$)(((...e)=>i.submitForm&&i.submitForm(...e)),["prevent"]))},[(0,s.Lk)("div",po,[fo,(0,s.bo)((0,s.Lk)("input",{type:"text",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>r.title=e),required:""},null,512),[[o.Jo,r.title]])]),(0,s.Lk)("div",ko,[vo,(0,s.bo)((0,s.Lk)("textarea",{id:"content","onUpdate:modelValue":t[1]||(t[1]=e=>r.content=e),required:""},null,512),[[o.Jo,r.content]])]),(0,s.Lk)("div",wo,[Lo,(0,s.Lk)("input",{type:"file",id:"preview",onChange:t[2]||(t[2]=(...e)=>i.handleFileUpload&&i.handleFileUpload(...e))},null,32)]),(0,s.Lk)("div",bo,[yo,(0,s.bo)((0,s.Lk)("select",{id:"tags","onUpdate:modelValue":t[3]||(t[3]=e=>r.selectedTag=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.tags,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.id},(0,u.v_)(e.tag_name),9,To)))),128))],512),[[o.u1,r.selectedTag]])]),Fo],32)])]),(0,s.bF)(d)])}var zo={name:"CreateMagazinePage",components:{Header:P,Sidebar:te,Footer:q},data(){return{title:"",content:"",selectedTag:"",tags:[]}},created(){this.$route.params.id&&this.fetchMagazine(),this.fetchTags()},methods:{handleFileUpload(e){},async submitForm(){this.$route.params.id?await this.updatePost():await this.createPost()},async fetchTags(){try{const e=await ne.getTags();this.tags=e.data}catch(e){console.error("Error fetching tags:",e)}},async createMagazine(){try{const e={name:this.title,description:this.content,tags:[this.selectedTag]},t=localStorage.getItem("authToken");if(!t)return void console.error("Token not found!");const a={Authorization:`Token ${t}`};await ne.createMagazine(e,{headers:a}),this.$router.push("/")}catch(e){console.error("Error creating magazine:",e)}},async fetchMagazine(){try{const e=await ne.getMagazinesById(this.$route.params.id);this.title=e.data.name,this.content=e.data.description,this.selectedTag=e.data.tags[0]}catch(e){console.error("Error fetching magazine:",e)}},async updateMagazine(){try{const e={name:this.title,description:this.content,tags:[this.selectedTag]},t=localStorage.getItem("authToken");if(!t)return void console.error("Token not found!");const a={Authorization:`Token ${t}`};await ne.updateMagazine(this.$route.params.id,e,{headers:a}),this.$router.push("/")}catch(e){console.error("Error updating magazine:",e)}}}};const _o=(0,l.A)(zo,[["render",Eo],["__scopeId","data-v-2411a54f"]]);var Co=_o;const Io=[{path:"/",component:me,name:me},{path:"/signup",component:Ve,name:Ve},{path:"/login",component:rt,name:rt},{path:"/choose-tags",component:wt,name:wt},{path:"/news/:id",component:Ct,name:Ct},{path:"/magazines",component:jt,name:jt},{path:"/magazine/:id",component:lo,name:lo},{path:"/create-magazine",component:Co,name:Co},{path:"/edit-magazine/:id",component:Co,name:Co,props:!0},{path:"/profile",component:ma,name:ma},{path:"/create-post",component:Xa,name:Xa},{path:"/edit-post/:id",component:Xa,name:Xa,props:!0},{path:"/admin",component:Za,name:Za}],So=(0,g.aE)({history:(0,g.LA)(),base:"static/",routes:Io});var Po=So;const Ao=(0,o.Ef)(d);Ao.use(Po),Ao.mount("#app")}},t={};function a(o){var s=t[o];if(void 0!==s)return s.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,a),n.exports}a.m=e,function(){var e=[];a.O=function(t,o,s,n){if(!o){var r=1/0;for(d=0;d<e.length;d++){o=e[d][0],s=e[d][1],n=e[d][2];for(var i=!0,l=0;l<o.length;l++)(!1&n||r>=n)&&Object.keys(a.O).every((function(e){return a.O[e](o[l])}))?o.splice(l--,1):(i=!1,n<r&&(r=n));if(i){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[o,s,n]}}(),function(){a.d=function(e,t){for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,n,r=o[0],i=o[1],l=o[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(s in i)a.o(i,s)&&(a.m[s]=i[s]);if(l)var d=l(a)}for(t&&t(o);c<r.length;c++)n=r[c],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(d)},o=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=a.O(void 0,[504],(function(){return a(1399)}));o=a.O(o)})();
//# sourceMappingURL=app.955d54a5.js.map